# Design notebook for week ending April 10, 2016

## Last week's critique

The critique that I received last week gave some good recommendations for storing tasting notes into a database. Daniel recommended that I create a database with future features in mind so as not to make it too closed. I think that's a good idea, since I could easily see my keywords changing as small things about the tasting notes format are altered in implementation. Unfortunately, I've moved away from a lot of the database aspects of my project and more towards visualizations. However, if I have time at the end it might be worth implementing more of a data storage mechanism than "store all tasting notes in a directory." I'm glad that he brought this up in the critique because I had mainly forgotten about that aspect of my project.

Daniel also talked about the ability to compare tasting notes with professionals. He said that it might be a good idea to link to professional opinions on a wine, even if they're not in the correct format. I agree with this and would like to keep that as a potential direction for the proejct. Even though I'm mostly focused on the visualization of tasting notes, there's no reason why I shouldn't also be able to include links to more information about the wine or pull a basic description of the wine from a database. It would be interesting to try and integrate this functionality later in the project. 

Several more things that Daniel mentioned in his critique were  comparing reviews with friends and altering the visualization format. I really like the idea of comparing reviews with friends, especially if a group goes out wine tasting. It's an interesting way to see what other people thought of the wine beyond just discussion of flavors. I'll probably talk about this below, but it seems like a great reach goal for the project, though I would be more likely to focus on it if I were building an actual app. Daniel talked about creating a customizable GUI where users could set the colors of various wine attributes, which got me thinking about users interacting with the visualizations. I could let users adjust colors and things like that, but I might try to let users select different types of charts for wine attributes. It's interesting to think about users comparing wines with their friends and then being able to edit their tasting notes or save their friends' tasting notes. Again, some of these would be more of a consideration for an app, but it's interesting to think about.

Finally, Daniel talked about assigning an overall score to a wine and how it might make more sense for the score to be a product of different wine attributes. I can see arguments for and against this, the latter being that it might be more difficult for users to score individual attributes of wines in my tasting notes format. Again, this is something to keep thinking about as I implement the tasting notes in the coming weeks.


## Description

This week, I determined the exact nature of my project and made some significant technical progress on it. I came out of last week uncertain about the best way to implement my project. I brought up the idea of representing user tasting notes with visualzations. I had a good idea for how the tasting notes would be formatted but did not have many concrete plans for how I would implement the graphic side of the project.

At the beginning of the week, I talked to Prof Ben and my critique partners about where to go with the project. I came into class knowing that I wanted to try and visualize tasting notes. First, I tried to find visualization languages that would allow me to represent the information I wanted. I had used the javascript library [d3](https://d3js.org/) in the past and was comfortable trying to write a DSL that would interact with it. I also found other DSLs such as [Raw](http://raw.densitydesign.org/) and [Timeline](http://timeline.knightlab.com/) that did similar things to my proposed project. They both allowed user-friendly input formats for visualization of data. Raw is built on d3, which gave me hope that my project would be similar to it once completed, though with the more specific domain of wine.

In general, my goal for a DSL is something that takes wine tasting notes in a text file and transforms them into graphical visualizations. I was worried that it would be closer to a web app than a DSL, but I talked about some of the technical background with Prof Ben. He suggested parsing the text files into JSON format and then visualizing that in d3. I decided to go with that suggestion. Another place I could add more linguistic functionality to the app is through different types of visualizations. I might be able to expand the language to support other tables or graphs, or possibly expand it to process different parts of the wine tasting notes. One thing that my critique partners suggested was side-by-side wine comparison with others. This is definitely outside the scope of my project, but I think it would eventually be fun to write an app that lets people take their own tasting notes and then compare their resulting visualizations with the people around them. It leaves room for wine as both an individual and a social experience. 

Once I knew how my project would be structured, I started getting into the technical details. As Prof Ben suggested in class, I began to look at it from both the user and final output ends. I knew that I wanted the users to write their initial tasting notes in text files (for ease in this project) and use d3 to output the files as graphics. In between, the text files would get parsed to JSON and passed into the d3 javascript. I had to figure out how to structure the project in order to convert between all of these different data formats. 

I quickly set up a basic d3 program using html and javascript. I used a [radial sunburst basic example](http://bl.ocks.org/mbostock/4348373) from mbostock, the creator of d3. This example is used to graph a [coffee flavor wheel](https://www.jasondavies.com/coffee-wheel/) and I thought it might be a good starting point for my wine visualizations. At this point, I was just trying to test if I could display anything. I got this visualization working and saw that all of the radial sunburst data being used to create the specific wheel pieces and layers was loaded from a JSON file. I then spent a while messing with the data and changing various parts of the visualization. It occurred to me that I could change the JSON file being loaded and get visualizations of different tasting notes. I spend far too long looking into application building platforms like [Meteor](https://www.meteor.com/) and [Node.js](https://nodejs.org/en/) because I knew I would be dealing with a lot of different files. I was also using Python to run a simple server from the command line in order to display the visualizations in Chrome. After wasting a lot of time, I realized that it would be simpler to get a small part of the project working and not spend so long on file structure.

My primary concern at this point was to build a sample program demonstrating the data flow from user to visualization. I decided to write most of the project in Python because it provides very easy tools for reading text files. I was already serving content on a Python server, so it made sense to build this functionality into my project file. On Prof Ben's recommendation, I picked that as my big language and started hooking the pieces of my project together. It took a lot of Googling, but eventually I wrote a Python program that could be run from the command line by typing `python run-server.py syrah.txt`. The text file argument in that command represents the tasting notes file to be visualized. This is then read by Python, converted into JSON, and placed in a file named `wine.json`. The `wine.json` file can then be accessed by the local server, since it lives in the same directory as the Python program.

My current code starts the Python server and then opens Chrome to the url `http://localhost:8080/?wine=wineFileName` where `wineFileName` is the name of the JSON file. In the future, I will save the JSON file by the same name as the text file, which should make the URL less confusing. Since Chrome is being opened to that URL on the local server, it runs the `index.html` file in the same directory. This is where all of my Javascript code is stored to take the name of the wine JSON file from the URL, add the `.json` extension, and visualize it in d3. Finally, the visualization corresponding to the initial text file is output in Chrome.

At this point, my main focus for next week is the txt to JSON parser. The current text file I'm passing as an argument is JSON in text format purely for the proof of concept. This means that my Python program reads the JSON string from the text file, converts it from a string to JSON, and dumps it into the JSON file. I have the software stack built in addition to the tasting notes format from the previous week so it's time to combine the two in this parser. Ideally, I'll be able to parse the tasting notes and visualize in this sunburst shape by the end of next week. In the fourth week, I'll be able to experiment with other visualization formats and expanded functionality for the parts of the tasting notes that can be represented graphically. As I mentioned in my critique, I would also like to be able to link to professional opinions about a given wine, so I might go back to some of the APIs I researched in the first week and look into how they could be integrated.


## Questions

As described above, my next big goals for the project are to work on the text file to JSON parser. I think that this is a big linguistic decision for me, especially since the grammar of the tasting notes will determine how flexible the format can be. I'm trying to decide which parts of the tasting notes can be optional, how to deal with files that don't contain some of the mandatory tasting notes attributes (error messages), and how I want to visualize different aspects of the tasting notes. 

At this point, I'll be happy with the basic structure of the project once I get the parser working. I think I'll still have some important implementation decisions to make for the visualization side of the process. If I choose to represent all attributes of the tasting notes in a single visualization, I need to determine a standard format. I also might make it so that users can customize their visualization (what parts of the tasting notes are displayed, the format in which they are shown, etc) which could get into the territory of another mini DSL. That's something I have to keep in the back of my mind as the project progresses, but it's a fun direction to consider.

At this point my biggest question is whether my software stack seems efficient. To display the JSON file on my local Python server, I pass the file name by URL (in Python) and then (in Javascript) load the corresponding JSON file in the directory to display. This works when I test it and I'm happy to keep using it for the remainder of the project, but it seems a bit convoluted. Are there any tools that you know about which would make this process easier? If possible, I would love something that doesn't necessitate passing parameters via URL. 

I intend to keep asking this question every week, but are there any other helpful visualizations for my tasting notes format? So far, I like the sunburst and a potential bar graph for charting the various flavors that people taste in a glass of wine. The rough sketch of my tasting notes format from last week is [here](https://goo.gl/photos/Kqqp9qn346wKMWQR8). Can you think of any way I could display information about those specific categories that would be appealing to users? Anything that users might want to customize?

**How much time did you spend on the project this week? If you're working in a
team, how did you share the labor?**

Including the time spent in class this week and the time to do this notebook entry, I spend about 10 hours on the project. I intend to spend a bit more before class on Monday so that I'll have an interesting example program to demonstrate.

